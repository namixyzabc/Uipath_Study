---

## 1. RPA実行端末のキッティング設定

### なぜキッティングが必要か？
**キッティング**とは、RPAロボットが安定して動作するように端末の設定を最適化することです。人間が使うPCの設定のままだと、以下のようなエラーが発生します。

### よくあるエラー例

| エラーの種類 | 具体例 | 原因 |
|-------------|--------|------|
| 🔔 **通知によるエラー** | メール通知やWindows更新通知が表示され、ロボットが操作を続けられない | 人向けの通知機能が有効 |
| 🖥️ **画面の問題** | 処理中に画面がスリープし、ロボットが画面を認識できない | 省電力設定が有効 |
| 📝 **入力予測の誤動作** | 入力欄に予期しない候補が表示され、間違った値が入力される | オートコンプリート機能が有効 |
| 🌐 **ブラウザの問題** | 必要なポップアップが表示されず、処理が停止 | ポップアップブロック設定 |

---

## 2. キッティング作業の3つのポイント

### ポイント1️⃣：通知をすべて停止
**理由**: RPAロボットは通知を読めないため、通知が表示されると処理が止まってしまいます。

### ポイント2️⃣：ポップアップを適切に制御
**理由**: 必要なポップアップは表示し、不要なものはブロックする設定が必要です。

### ポイント3️⃣：使用アプリケーションの詳細設定
**理由**: Excel、Outlook、SAPなどの個別設定で、ロボットの動作を妨げる機能を無効化します。

---

## 3. 詳細設定手順

### 🖥️ PC本体の設定

#### 画面スリープ設定
```
設定手順：
1. 「設定」→「システム」→「電源とスリープ」
2. 「画面」と「スリープ」の時間を「なし」に変更

追加設定：
1. 「コントロールパネル」→「電源オプション」→「電源ボタンの動作を選択する」
2. すべてのボタンアクションを「何もしない」に変更
```

**例**: 夜間バッチ処理中に画面がスリープしてロボットが停止することを防げます。

#### 通知設定
```
設定手順：
1. 「設定」→「システム」→「通知とアクション」
2. すべての通知を「オフ」に変更
```

#### 画面表示設定（重要⚠️）
```
設定手順：
1. 「設定」→「システム」→「ディスプレイ」  
2. 「テキスト、アプリ、その他項目のサイズ変更」を100％に設定
3. 解像度を開発端末と同じ値に設定
```

**なぜ重要？**: 画面の拡大率や解像度が異なると、ロボットがボタンやテキストボックスを見つけられなくなります。

#### 予測入力の無効化
```
設定手順：
1. 「設定」で「IME」を検索
2. 「日本語IME設定」→「全般」
3. 「予測候補を表示するまでの文字数」を「オフ」
```

#### Windows Update設定
```
設定手順：
1. 「設定」→「更新とセキュリティ」→「Windows Update」
2. 「アクティブ時間の変更」でロボット稼働時間を設定
   例：5:00-23:00（最大18時間）
```

---

### 🌐 ブラウザの設定

#### Google Chrome / Microsoft Edge共通設定

##### ポップアップ設定
```
Chrome設定手順：
1. Chrome設定→「プライバシーとセキュリティ」→「サイトの設定」
2. 「ポップアップとリダイレクト」
3. 必要なサイトを「許可」リストに追加

Edge設定手順：
1. Edge設定→「サイトのアクセス許可」
2. 「ポップアップとリダイレクト」  
3. 必要なサイトを「許可」リストに追加
```

**例**: 社内システムからPDFをダウンロードする際のポップアップを許可

##### ダウンロード設定
```
設定手順：
Chrome：「ダウンロード前に各ファイルの保存場所を確認する」を有効
Edge：「ダウンロード時の動作を毎回確認する」を有効
```

##### パスワード保存の無効化
```
設定手順：
両ブラウザとも「パスワードの保存提案」を無効に設定
```

**理由**: RPAロボットは毎回確実にログイン情報を入力するため、ブラウザの保存機能は不要です。

---

### 📊 アプリケーション個別設定

#### Microsoft Excel
```
オートコンプリート無効化：
1. 「ファイル」→「オプション」→「詳細設定」
2. 「オートコンプリートを使用する」のチェックを外す

リボン設定：
リボンを常に表示するよう固定
```

**例**: セル入力時に過去の入力候補が表示されて、意図しない値が入力されることを防げます。

#### Microsoft Outlook
```
設定項目：
- アラーム機能：オフ
- リボン表示：常に表示で固定
- レイアウト：デフォルト設定で統一
```

#### SAP
```
スクリプト有効化設定：
1. SAPログイン後、「オプション」（またはAlt+F12）
2. 「アクセシビリティ＆スクリプト」→「スクリプト」
3. 「スクリプト有効化」にチェック
```

**重要**: この設定がないとSAPの操作が一切できません。

---

## 4. ブラウザバージョンアップ時のエラー対応

### よくあるエラーパターン

#### パターン1️⃣：オブジェクト位置の変更
**症状**: 「ログインボタンが見つかりません」エラー  
**原因**: ブラウザ更新でボタンの位置や見た目が変更  
**対応方法**: 
- レコーダーキャプチャを再取得
- アクションパッケージのバージョン更新

#### パターン2️⃣：ウィンドウタイトルの変更
**症状**: 「指定されたウィンドウが見つかりません」エラー  
**原因**: ページタイトルの変更  
**対応方法**:
```
修正例：
変更前：「売上管理システム - Chrome」
変更後：「売上管理システム v2.0 - Chrome」

解決策：ワイルドカード使用
設定値：「売上管理システム* - Chrome」
```

#### パターン3️⃣：新仕様の追加
**症状**: 新しいポップアップで処理が止まる  
**原因**: セキュリティ強化等で新しい確認画面が追加  
**対応方法**: 新しい画面処理をロボットに追加

---

### 実際の解決事例

#### 🔧 事例1：Google Chrome レポート出力エラー
**問題**: レポート出力ボタンを認識できない

**解決方法**:
```
対応手順：
1. 該当のレコーダーアクションを選択
2. アクションパッケージのバージョンを最新に更新
3. ロボットを再実行
```

#### 🔧 事例2：Microsoft Edge ウィンドウ切り替えエラー  
**問題**: 伝票送信後、元画面の操作ができない

**解決方法**:
```
追加設定：
1. 「ウィンドウ：アクティブ化」アクションを追加
2. 操作対象ウィンドウを最優先に指定
3. 「レコーダー：キャプチャ」でアクティブ化したウィンドウ変数を指定
```

---

### 🚨 最終手段：一時的対処法

#### ブラウザの旧バージョン設定（Chrome）
```
緊急時の対応：
1. Chromeのアドレスバーに「chrome://flags/#chrome-refresh-2023」を入力
2. 設定を「Disabled」に変更
3. ブラウザを再起動
```

⚠️ **注意**: これは一時的な対処法です。セキュリティリスクがあるため、RPAツールの対応後は速やかに最新版に戻してください。

#### 自動化範囲の見直し
どうしても解決できない場合は：
1. 自動化可能な部分と手作業部分を分類
2. 依頼元と相談して自動化範囲を調整
3. コストパフォーマンスを考慮して判断

---

## まとめ

✅ **事前のキッティング設定でエラーの80%は防げる**  
✅ **ブラウザ更新エラーは軽微な調整で解決できることが多い**  
✅ **解決できない場合は自動化範囲の見直しを検討**  

RPAの安定稼働には、技術的な対応だけでなく、運用面での柔軟性も重要です。
