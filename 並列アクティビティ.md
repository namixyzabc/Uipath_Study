---

## ⚡ 並列（Parallel）アクティビティ解説

### 🎯 並列アクティビティとは

**配置場所：** UiPath Studio の「ワークフロー＞制御」カテゴリ

**基本概念：** 
複数の処理を「同時に」実行するように見えるアクティビティですが、実際の動作には重要な仕組みがあります。

### 🔄 動作の仕組み

#### **スレッドとは？**
```
プログラムの「作業の流れ」のようなもの

[メインスレッド] ────→ 処理A ────→ 処理B ────→ 処理C
                     (順番に実行)

[並列処理]     ────→ 処理A ────→
              └────→ 処理B ────→
                     (同時に実行)
```

#### **アイドル状態とは？**
アクティビティが一時的に処理を停止している状態
- 特定のイベントの発生を待っている
- 別の処理の完了を待っている
- このとき他のアクティビティが実行可能になる

### 📝 実行パターンと結果

#### **パターン1: 同期アクティビティ同士**
```
[並列アクティビティ]
├── [同期処理A] ────→ 完了まで待機
└── [同期処理B] ────→ Aの完了後に開始

結果: 順番に実行される（並列にならない）
```

#### **パターン2: 非同期アクティビティ同士**
```
[並列アクティビティ]
├── [非同期処理A] ────→ 別スレッドで実行
└── [非同期処理B] ────→ すぐに開始

結果: 真の並列処理が実現
```

### 🌐 実用的な使用例

#### **1. HTTP APIの並列呼び出し**
```yaml
例: 複数のWebサービスから同時にデータ取得

[並列アクティビティ]
├── [HTTP要求] 天気予報API呼び出し
├── [HTTP要求] 株価API呼び出し  
└── [HTTP要求] ニュースAPI呼び出し

通常: 3つのAPI呼び出しで6秒かかる場合
並列: 最も遅いAPIの2秒で完了（4秒短縮）
```

#### **2. ダイアログ対応の効率化**
```yaml
例: ファイル保存時の確認ダイアログ処理

[並列アクティビティ]
├── [クリック] 「上書きしますか？」への自動応答待機
└── [シーケンス] メインのファイル保存処理

効果: ダイアログが表示されない場合でも
      タイムアウトを待たずに処理が進む
```

### ⚠️ 重要な制限事項

#### **1. UI操作の制限**
```yaml
❌ 同時に複数のUI操作はできない
理由: キーボード・マウスのフォーカスは1箇所のみ

例: 同時に2つのボタンをクリック → 失敗
    同時に2つの入力欄に文字入力 → 失敗
```

#### **2. Excel操作の制限**
```yaml
❌ Excelファイルの並列処理は効果なし
理由: Excel自体が内部で順番に処理する仕様

例: 3つのExcelファイルを並列処理
    → Excel内部で順番に処理されるため時間短縮されない
```

#### **3. 同一アプリケーションでの制限**
```yaml
❌ 同じアプリの複数箇所を同時操作
理由: UIスレッドはアプリごとに1つのみ

例: 同じExcelファイルの複数シートを同時操作 → 失敗の可能性
```

### 🛠️ 代替手段：プロセス分離

並列処理を確実に行いたい場合の解決策：

```yaml
方法: Invoke Workflow Fileアクティビティの「分離」プロパティをON

[メインワークフロー]
├── [Invoke Workflow File (分離=True)] ワークフローA.xaml
├── [Invoke Workflow File (分離=True)] ワークフローB.xaml
└── [Invoke Workflow File (分離=True)] ワークフローC.xaml

効果: それぞれが別のWindowsプロセスで実行される
注意: プロセス起動時間がかかる、データ連携が制限される
```

### 📋 使用時のベストプラクティス

#### **✅ 適している用途**
- HTTP API呼び出し
- SOAP Webサービス呼び出し
- 独立したファイル処理（異なるファイル）
- 待機処理を含む操作

#### **❌ 避けるべき用途**
- UI操作の並列実行
- 同じExcelファイルの操作
- 同じアプリケーション内での複数操作
- データベースの同時更新（競合の可能性）

### 🎯 まとめ

並列アクティビティは正しく理解して使用すれば、自動化処理の効率化に大きく貢献します。特に**非同期アクティビティ**（HTTP要求など）との組み合わせで真価を発揮しますが、UI操作やExcel操作では期待した効果が得られない場合があることを理解して活用しましょう。
